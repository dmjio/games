<!DOCTYPE html>
<html>
<head>
<script src="jquery.js"></script>
<script src="game.js"></script>
<script src="ui.js"></script>
<script src="drawEvent.js"></script>
<script>

function dumpAllCards() {
  var b = $('body')
  jQuery.getJSON('getCards',null,function(cards) {
    console.log(cards)
    jQuery.each(cards, function(cat,cs) {
      b.append($('<h3/>').text(cat))
      jQuery.each(cs,function(ix,c) {
        b.append(drawCard(c))
      })
    })
  })
}

function classBox() {
  function val(x) { return $('<option/>').attr('value',x).text(x) }

  return $('<select/>').append(val('DEATH CARDS')
                              ,val('HOLY CARDS')
                              ,val('MECHANICAL CARDS')
                              ,val('ILLUSION CARDS')
                              ,val('BEAST CARDS')
                              ,val('GOBLIN\'S CARDS')
                              ,val('CHAOS CARDS')
                              ,val('SORCERY CARDS')
                              ,val('FOREST CARDS')
                              ,val('DEMONIC CARDS')
                              )
}

function drawNewGame() {

  var helpBox = $('<div/>')
                .attr('id','helpBox')
                .css('height', '15ex')
                .css('overflow','auto')

  var helpBtn = $('<button/>').text('Click to see help')

  helpBtn.click(function() {
    helpMode = !helpMode
    helpBtn.text(helpMode? 'Click to play' : 'Click to see help')
  })


  var p1 = classBox()
  var p2 = classBox()
  var btn = $('<button/>').text('New game')
                          .click(function() {
    newGame('newGame', { player1: $(p1).val(), player2: $(p2).val() })
  })

  return $('<div/>').append(p1,p2,btn,helpBtn, helpBox)
}

function newGame(m,opts) {
  var b = $('body').empty()
  b.append(drawNewGame())
  jQuery.getJSON(m,opts,function(res) {
    gameID = res.gid
    b.append(drawGame(res.game))
  })
}


$(document).ready(function() {
  // dumpAllCards()
  newGame('getState')

})
</script>
<style>
.selected { border: 2px solid red; }
.disabled { opacity: 0.5; }
/* body { background-image: url("img/background.jpg") } */
</style>
<head>
<body>
</body>
</html>
